# 1 导论

注意：课程笔记需结合幻灯片学习。

1. 在本节课程中，我们学习密码学导论

2. 目录：内容包括密码学中对称加密基本概念，古典密码学，现代密码学原则

3. 密码学概念

   - 密码学来自希腊单词kryptos，意为“隐藏，保密”，和graphin，意为“书写”，即秘写。
   - 密码学在简明牛津字典中定义为书写或破解代码（code）的艺术。其中，Code（代码）是一个预先编排好的符号的系统，特别用于确保消息传输中的秘密。另外中文口语中“密码”相关的英文单词还包括password（口令），cipher（加密方案），key（密钥），这些在中文表达中要注意区分。
   - 现在密码学的开端在1980年代，以DES、公钥密码学等成果为代表，密码学从军用转变为民用。个人计算机产业，互联网也如此。
   - 教材中对现代密码学定义：用于保护数字信息，系统和分布式计算免于敌对攻击的数学技术的科学研究。

4. 私钥加密（private key encryption）设定

   - 目标是构造一个用于在预先共享了私钥（对称密钥）的双方之间进行保密通信的加密方案
   - 隐含一个假设：存在某种方法以保密的方式来初始分享一个密钥
   - 磁盘加密相当于同一个人在不同的时刻间通信

5. 加密的词法

   - Alice作为发送者向Bob作为接收者发送一个消息，该消息使用一个对称密钥加密。敌手窃听密文，尝试获得明文。

   - **key** 密钥 $k \in \mathcal{K}$, **plaintext (or message)** 明文或消息 $m \in \mathcal{M}$, **ciphertext** 密文 $c \in \mathcal{C}$
   - **Key-generation Algorithm** 密钥生成算法 $k \gets \mathsf{Gen}$
   - **Encryption Algorithm** 加密算法 $c:= \mathsf{Enc}_k(m)$
   - **Decryption Algorithm** 解密算法 $m:= \mathsf{Dec}_k(c)$
   - **Encryption scheme** 加密方案: $\Pi = (\mathsf{Gen}, \mathsf{Enc}, \mathsf{Dec})$
   - **Basic correctness requirement** 基本正确性要求 : $\mathsf{Dec}_k(\mathsf{Enc}_k(m)) = m$

6. 保护密钥与隐瞒算法

   - 更容易维护一个短密钥的秘密
   - 在密钥暴露的情况下，对于诚实方，更换密钥更容易
   - 在许多对人员的情况，更容易采用相同算法，不同密钥
   - **Kerchhoffs原则**：加密方法一定不需要是一个秘密，而且必须落入敌手也没有任何麻烦

7. 为什要“开放密码学设计”？

   - 发表的设计经过公开检视会更强健
   - （相对于由攻击者）由有道德的黑客来发现安全缺陷会更好
   - 即便不公开，代码逆向工程（或被工业间谍泄漏）也构成了严重的安全威胁
   - 建立标准

8. 攻击场景

   - 除了窃听密文（称为COA），敌手还有其它手段

   - **Ciphertext-only (COA)** 唯密文: 敌手只观察密文
   - **Known-plaintext (KPA)** 已知明文: 敌手获知同一密钥下的若干明文/密文对
   - **Chosen-plaintext (CPA)** 选择明文: 敌手有获得所选择明文加密（获得该明文的密文）的能力
   - **Chosen-ciphertext (CCA)** 选择密文: 敌手有获得所选择的**其它密文**解密（获得该密文的明文）的能力
   - 被动攻击: COA KPA，由于不是所有密文都是机密的
   - 主动攻击: CPA CCA，当敌手能够加密/解密任何其所希望的信息

9. 历史上的加密方案及其密码分析（Cryptanalysis）

   - 学习古典密码的目的是了解加密并没有想象的复杂，但设计安全的加密是很困难的，并且学习一些密码学设计的基本原则。

   - 凯撒加密方案（Caesar's Cipher）：凯撒将机密消息加密书写，这是将字母表中字母顺序改变使得没有一个单词可以被理解。若有人要解密，则他必须将字母表中第四个字母，即D，替换成A，并且对其它字母也这么做。
   - $\mathsf{Enc}(m)=m+3\mod 26$
   - 例子：明文`begintheattacknow`，采用凯撒加密的密文是什么？
   - 其弱点是什么？

10. 移位加密（Shift Cipher）

    - $\mathsf{Enc}_k(m)=m+k\mod 26$
    - $\mathsf{Dec}_k(c)=c-k\mod 26$
    - 例子：解密`EHJLQWKHDWWDFNQRZ`
    - 弱点: ?
    - **充分密钥空间原则**：任何安全加密方案必须具有一个经受住穷举搜索的密钥空间
    - 问题：如何在穷举过程中自动化地确定密钥？

11. 重合指数（Index of Coincidence）方法（寻找密钥 $k$）

    - 重合指数$I$是两个随机挑选（挑选后放回）字母相同的概率

    - 令 $p_i$表示英文文本中第$i$个字母的概率

      $$ I \overset{\text{def}}{=}\sum_{i=0}^{25} p_i^2 $$

    - 例子：计算`apple`的重合指数

    - 对于足够长的英文文本，其重合指数为0.065。对于 $j = 0, 1, \dotsc , 25$, $q_j$为密文中第 $j$ 个字母的概率，

      $$ I_j \overset{\text{def}}{=}\sum_{i=0}^{25} p_i \cdot q_{i+j} $$

    - 问题：对于移位加密，若$j = k$, 则 $I_j \approx$ ? 为什么？（$a^2 + b^2 > 2ab$）

    - 这不是大数据+人工智能吗!?

12. 单表替换加密（Mono-Alphabetic Substitution）

    - 思想：将每个字符以任意方式映射到一个不同字符
    - 优点：密钥空间足够大 $\approx 2^{88}$。如何计算的？
    - 缺点：？
    - 明文`abcdefghijklmnopqrstuvwxyz`
    - 密文`XEUADNBKVMROCQFSYHWGLZIJPT`
    - 明文`tellhimaboutme` ，密文？

13. 利用统计模式来攻击

    1. 将密文中字符的频率制表
    2. 与英文文本中字符频率比较
    3. 猜测频率最高的字母对应e，如此进行
    4. 挑选“合理的”明文，但并不简单

14. 一个密文例子，人眼很难看出个所以然来

15. 一个频率分析的例子，计数，猜，试错

16. 一个频率分析出的明文，《金甲虫》小说片段

17. 维吉尼亚（多表移位）加密  (Vigenere (poly-alphabetic shift) Cipher)

    - 思想：通过将明文中相同字母的不同出现映射到密文中不同字母，以此抹平密文中统计分布。
    - 加密：$c_i=m_i+k_{[i\bmod t]}$, $t$ 是 $k$ 的长度（周期）
    - 密码分析：需要发现 $t$；若 $t$ 已知，则需要知道解密是否“合理”，但当$t > 15$时，蛮力破解 ($26^t$) 不可行。 

18. Kasiski的方法（寻找周期 $t$）

    - 多表位移加密在2百多年内未被有效破解，直到...
    - 识别出长度2或3的重复模式，猜想这些重复应该是由于相同的明文片段被相同密钥片段加密的结果；
    - 那么，假设密钥中没有重复模式，则这些重复出现之间的距离应该是密钥长度 $t$ 的倍数；
    - 那么，假设明文中重复模式是随机的，则密钥长度 $t$ 是所有重复出现间距离的最大公约数；
    - 但重复出现也可能是巧合，有没有更有效的方法？

19. 重合指数法（寻找周期 $t$）

    - 对于 $\tau = 1, 2, \dotsc$, $q_i$ 是 $c_1, c_{1+\tau}, c_{1+2\tau}, \dotsc$,中第 $i$ 个字母出现的概率，重合指数等于

      $$ I_\tau \overset{\text{def}}{=}\sum_{i=0}^{25} q_i^2 $$

      若 $\tau = t$, 那么 $I_\tau \approx ?$ ; 这里通过遍历 $\tau$ 来寻找 $t$, 若 $\tau = t$, 则 $q_i$ 就是被使用了同一个密钥的移位加密所得到的密文 $c_1, c_{1+t}, c_{1+2t}, \dotsc$，即其中相同的明文字母被映射为相同的密文字母，因此，重合指数$I_\tau$与明文的相同。

      否则， $q_i \approx \frac{1}{26}$ 并且

      $$ I_\tau \approx \sum_{i=0}^{25} \left(\frac{1}{26}\right)^2 \approx 0.038 $$

      此时，假设所挑选出的密文是由明文字母被某个密钥中随机的字母映射所得到的，还假设密钥足够长且其中字母足够多样，则密文中每个字母出现是充分随机的，即出现概率为1/26，（在完美保密部分会进一步学习）。

      然后，可以再次使用重合指数法寻找密钥中每个位置 $i$ 的字符 $k_i$.

    - 任意敌手原则 (Arbitrary Adversary Principle)：对于一类具有指定能力的敌手们，对于其中任意一个敌手，安全必须被确保。换句话说，安全与否只考虑敌手能力，不受敌手具体策略左右。

20. 密码分析（作业）

    - 在COA下，对密文的需求与密钥空间规模有关。多表移位 > 单表替换 > 移位
    - 在KPA下，很容易破解。
    - 通过古典密码学到的教训：
      - 充分密钥空间原则
      - 设计加密方案是一项艰巨的任务
      - 复杂性不意味着安全
      - 任意敌手原则

21. 现代密码学原则：定义，假设，证明

    1. 安全和威胁模型的严格定义的形式化
    2. 当一个加密方案的安全依赖于无法证明的假设时，这个假设必须被精确地描述并且尽可能地小
    3. 加密方案应该带有一个基于以上定义和假设对安全性的严格证明

22. 原则1，对精确定义的形式化

    - 如何形式化私钥加密的安全？
    - 已知密文，没有敌手能够找到密钥， $\mathsf{Enc}_k(m)=m$
    - 没有敌手能够找到与密文所对应的明文，$\mathsf{Enc}_k(m)=m_{0}\| \mathsf{AES}_k(m)$，其中$m_0$表示第一个比特
    - 没有敌手能够确定与密文所对应的明文中任意字符，$m=1000$, 但有人能知道 $ 800 < m < 1200$
    - 没有敌手能够从密文中获得关于明文的任何有意义的信息，但如何定义“有意义”?

23. 原则1，如何定义

    - 根据图灵对计算的定义，需要直觉，证明定义等价，用该定义来解决例子。

24. 原则2，依赖于精确的假设

    - 大多数密码学构造不能够被无条件的证明安全，换句话说，当假设为真，则构造安全。
    - 假设需要验证，方案需要比较，证明需要假设
    - 简单，低级的假设容易被研究，拒绝和修正

25. 原则3，安全性的严格证明

    - 安全性需要否定式证明，如何证明没有人能破解？如何证明“非洲没有大象？”
    - 规约法（Reduction）：给定假设X是真，则根据定义构造Y是安全的。
    - 证明：将X的问题规约到破解Y的问题。
    - 这里X中每个问题都是难题，假设其无法解决。规约的意思是，可以将每个X中的问题转换为一个破解Y的问题，并且若一个破解Y的问题有答案，则可以由此答案构造一个对X中该问题的解。这里试图证明对Y的破解问题比X中问题要难。因为，假设了X中问题无法解决，而破解Y比X中问题还难，则破解Y也不可能。

26. 余下部分略

    

    